<script src="https://cdn.jsdelivr.net/gh/orstavik/parse/parse.js"></script>
<script src="../MonkeyPatch/MonkeyPatch.js"></script>
<script src="constructionFrame.js"></script>
<script>
  (function () {

    window.addEventListener('error', e => e.preventDefault());
    window.addEventListener('error', _ => console.log('error'));

    // ConstructionFrame.observe('start', f => console.log(f.toString()));
    ElementObserver.end( (f, el) => console.log(f.toString() + " " + el.tagName));
    ElementObserver.complete( (f, el) => console.log(f.toString() + " " + el.tagName));

    class InnerComp extends HTMLElement {
      constructor() {
        super();
        console.log(`${ElementObserver.now} constructor-inner`);
        throw new Error('test error');
      }
    }

    customElements.define('inner-comp', InnerComp);

    class OuterComp extends HTMLElement {
      constructor() {
        super();
        console.log(`${ElementObserver.now} constructor-outer`);
        this.attachShadow({mode: "open"});
        document.createElement('inner-comp');
      }
    }

    customElements.define('outer-comp', OuterComp);
  })();
</script>

<outer-comp></outer-comp>